package thread_4;

/** 스레드 대기( Thread Waiting )
 *  스레드가 특정 조건이 충족될 때까지 실행을 멈추고 기다리는 상태를 의미합니다.
 *  자바에서는 스레드가 공유 자원에 안전하게 접근할 수 있도록 
 *  스레드 대기와 관련된 메커니즘을 제공합니다.
 *  이를 통해 스레드 간 효율적인 협력을 구현할 수 있다.
 *  
 *  [ 스레드 상태와 대기 ]
 *  스레드는 다음과 같은 상태를 가질 수 있으며, 대기는 주로, 
 *  WATING, TIMED_WAITING, 또는 BLOCKED 상태와 관련이 있습니다.
 *  ㅇ Thread.currentThread().getState();
 *  ㅇ NEW : 스레드가 생성되었지만 아직 시작되지 않은 상태
 *  ㅇ RUNNABLE : 실행
 *  */  
public class ThreadSync_6 {

	public static void main(String[] args) {
		SharedResource resource = new SharedResource();
		Thread producer = new Thread(()-> {
			try {
				resource.produce();
			} catch (InterruptedException e) {
				e.printStackTrace();
			}
		});
		
		// resource(SharedResource)객체의 consume 메서드 참조
		Thread consumer = new Thread(resource::consume);
//		Thread consumer2 = new Thread(() -> {
//			resource.consume();
//		});
		producer.start();
		consumer.start();
	}
}

class SharedResource {
	
	public synchronized void produce() throws InterruptedException{
		System.out.println("Producing...");
		wait();	// Thread 대기상태로 진입
		System.out.println("Resumed production.");
	}
	
	public synchronized void produce2() throws InterruptedException{
		System.out.println("Producing...");
		wait();	// Thread 대기상태로 진입
		System.out.println("Resumed production.");
	}
	
	public synchronized void consume() {
		System.out.println("Consuming...");
		notify(); // 대기 상태인 Thread를 깨움
	}
}